This is chapter 4 for the master branch. 